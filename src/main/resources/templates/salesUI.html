<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>메인) 전체 매출 조회(월별)</title>

    <!-- Bootstrap -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">

    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <style>
        body { background-color: #fdfdfd; }
        .top-bar {
            background-color: #7be3a4;
            padding: 8px 16px;
        }
        .kpi-card {
            background: #fff;
            border: 1px solid #ccc;
            border-radius: 10px;
            padding: 18px;
            text-align: center;
        }
        .kpi-title { font-size: 14px; color: #444; }
        .kpi-value { font-size: 22px; font-weight: 600; margin-top: 6px; }
        .section-box {
            background: #fff;
            padding: 20px;
            border-radius: 10px;
            border: 1px solid #ddd;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
        }
    </style>
</head>

<body class="p-2">

<div class="border border-primary p-2" style="max-width:1200px; margin:0 auto;">
    <div class="fs-4 fw-bold mb-2">메인) 전체 매출 조회(월별)</div>

    <!-- 상단 메뉴 바 -->
    <div class="top-bar d-flex align-items-center">

        <div class="btn-group me-3">
            <button class="btn btn-light btn-sm">회사 로그</button>
            <button class="btn btn-secondary btn-sm">회사 명</button>
        </div>

        <ul class="nav">
            <li class="nav-item">
                <a class="nav-link active fw-bold text-dark" href="#">매출 ▾</a>
            </li>
            <li class="nav-item">
                <a class="nav-link text-dark" href="#">재고 ▾</a>
            </li>
            <li class="nav-item">
                <a class="nav-link text-dark" href="#">메뉴 ▾</a>
            </li>
            <li class="nav-item">
                <a class="nav-link text-dark" href="#">직영점</a>
            </li>
        </ul>

        <div class="ms-auto d-flex align-items-center gap-2">
            <span>본사 홍길동</span>
            <button class="btn btn-outline-primary btn-sm">로그아웃</button>
        </div>
    </div>

    <!-- 보기 + 기간/라디오 -->
    <div class="mt-3 px-2">

        <!-- 보기 -->
        <div class="d-flex align-items-center mb-2">
            <span class="me-2">보기</span>
            <div class="btn-group" role="group">
                <button class="btn btn-warning btn-sm">차트</button>
                <button class="btn btn-outline-secondary btn-sm">목록</button>
            </div>
        </div>

        <!-- 일/주/월/연 + 조회기간 -->
        <div class="d-flex align-items-center flex-wrap gap-2 mb-3">
            <div>
                <div class="form-check form-check-inline">
                    <input class="form-check-input" type="radio" name="period" id="day">
                    <label class="form-check-label" for="day">일별</label>
                </div>
                <div class="form-check form-check-inline">
                    <input class="form-check-input" type="radio" name="period" id="week">
                    <label class="form-check-label" for="week">주별</label>
                </div>
                <div class="form-check form-check-inline">
                    <input class="form-check-input" type="radio" name="period" id="month" checked>
                    <label class="form-check-label" for="month">월별</label>
                </div>
                <div class="form-check form-check-inline">
                    <input class="form-check-input" type="radio" name="period" id="year">
                    <label class="form-check-label" for="year">연별</label>
                </div>
            </div>

            <span class="ms-3 fw-semibold">조회기간</span>
            <input type="date" class="form-control form-control-sm" style="width:150px;" value="2024-05-01">
            <span>~</span>
            <input type="date" class="form-control form-control-sm" style="width:150px;" value="2025-03-31">
        </div>
    </div>

    <!-- KPI 카드 -->
    <div class="row g-3 mb-3 px-2">
        <div class="col-md-3">
            <div class="kpi-card">
                <div class="kpi-title">전체 매출</div>
                <div class="kpi-value">450,000,000</div>
            </div>
        </div>

        <div class="col-md-3">
            <div class="kpi-card">
                <div class="kpi-title">총 판매 수량</div>
                <div class="kpi-value">120,000</div>
            </div>
        </div>

        <div class="col-md-3">
            <div class="kpi-card">
                <div class="kpi-title">평균 직영점 매출</div>
                <div class="kpi-value">30,400</div>
            </div>
        </div>

        <div class="col-md-3">
            <div class="kpi-card">
                <div class="kpi-title">전월 대비 매출 성장</div>
                <div class="kpi-value">5%</div>
            </div>
        </div>
    </div>

    <!-- 메인 그래프 -->
    <div class="section-box mb-4 mx-2">
        <h6 class="mb-3 fw-bold">전체 매출 추이</h6>
        <canvas id="mainChart" height="90"></canvas>
    </div>

    <!-- 서브 차트 -->
    <div class="row g-3 mb-3 px-2">

        <div class="col-md-6">
            <div class="section-box">
                <h6 class="fw-bold mb-3">지점별 매출금액 TOP 5</h6>
                <canvas id="storeTop5Chart" height="130"></canvas>
            </div>
        </div>

        <div class="col-md-6">
            <div class="section-box">
                <h6 class="fw-bold mb-3">메뉴별 매출 비중</h6>
                <canvas id="menuPieChart" height="130"></canvas>
            </div>
        </div>
    </div>

</div>


<!-- ===========================
     스크립트
=========================== -->
<script>
    /* ---------------------------
       기간별 데이터 정의
    --------------------------- */
    const chartData = {
        day: {
            labels: ['10/01','10/02','10/03','10/04','10/05','10/06','10/07'],
            data:   [12, 15, 9, 14, 18, 16, 21],
            kpi: "전일 대비 매출 성장"
        },
        week: {
            labels: [
                '10/06 ~ 10/12 (W41)',
                '10/13 ~ 10/19 (W42)',
                '10/20 ~ 10/26 (W43)',
                '10/27 ~ 11/02 (W44)'
            ],
            data:   [380, 410, 395, 420],
            kpi: "전주 대비 매출 성장"
        },
        month: {
            labels: ['5월','6월','7월','8월','9월','10월','11월','12월','1월','2월','3월'],
            data:   [380000000, 400000000, 395000000, 360000000, 335000000,
                360000000, 345000000, 355000000, 380000000, 410000000, 450000000],
            kpi: "전월 대비 매출 성장"
        },
        year: {
            labels: ['2021','2022','2023','2024','2025'],
            data:   [4.2, 4.6, 5.1, 5.8, 6.3],
            kpi: "전년 대비 매출 성장"
        }
    };


    /* ---------------------------
       KPI 카드 4번 텍스트 변경 함수
    --------------------------- */
    function updateKpiLabel(type) {
        const title = document.querySelectorAll('.kpi-title')[3];
        title.textContent = chartData[type].kpi;
    }


    /* ---------------------------
       메인 그래프 생성 함수
    --------------------------- */
    let mainChart;

    function createMainChart(type) {
        const canvas = document.getElementById('mainChart');
        const ctx = canvas.getContext('2d');

        if (mainChart) mainChart.destroy();

        const chartType = (type === 'year') ? 'bar' : 'line';

        mainChart = new Chart(ctx, {
            type: chartType,
            data: {
                labels: chartData[type].labels,
                datasets: [{
                    label: '매출액',
                    data: chartData[type].data,
                    borderColor: '#007bff',
                    backgroundColor: (chartType === 'bar')
                        ? 'rgba(0,123,255,0.6)'
                        : 'rgba(0,123,255,0.15)',
                    borderWidth: 2,
                    fill: chartType !== 'bar',
                    tension: 0.3
                }]
            },
            options: {
                responsive: true,
                scales: {
                    y: { beginAtZero: false }
                }
            }
        });

        updateKpiLabel(type);
    }

    /* ---------------------------
       초기 로드 → 월별 그래프
    --------------------------- */
    createMainChart('month');

    /* ---------------------------
       라디오 버튼 이벤트
    --------------------------- */
    document.querySelectorAll('input[name="period"]').forEach(radio => {
        radio.addEventListener('change', () => {
            createMainChart(radio.id);
        });
    });


    /* ---------------------------
       서브 차트 (기존 그대로 유지)
    --------------------------- */
    new Chart(document.getElementById('storeTop5Chart'), {
        type: 'bar',
        data: {
            labels: ['가산1호점', '강릉경포점', '부산서면점', '가산2호점', '부천시청점'],
            datasets: [{
                label: '매출금액(개)',
                data: [820, 740, 690, 650, 610],
                backgroundColor: [
                    '#0d6efd', '#6f42c1', '#d63384', '#fd7e14', '#198754'
                ]
            }]
        },
        options: {
            indexAxis: 'y',
            responsive: true
        }
    });

    new Chart(document.getElementById('menuPieChart'), {
        type: 'doughnut',
        data: {
            labels: ['페퍼로니', '치즈피자', '콤비네이션', '불고기피자', '고구마피자'],
            datasets: [{
                data: [25, 18, 30, 15, 12],
                backgroundColor: [
                    '#ff6384', '#36a2eb', '#ffcd56', '#4bc0c0', '#9966ff'
                ]
            }]
        },
        options: { responsive: true }
    });

</script>
</body>
</html>
