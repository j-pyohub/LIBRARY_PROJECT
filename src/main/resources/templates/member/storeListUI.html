<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>직영점 목록 조회</title>

  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>

  <script type="text/javascript"
          src="//dapi.kakao.com/v2/maps/sdk.js?appkey=KakaoAK1234567890000000000000&libraries=services"></script>

  <style>
    body {
      background-color: #e5e5e5;
    }
    .top-bar {
      background-color: #7be3a4;
      padding: 8px 16px;
    }
    .section-box {
      background: #fff;
      border-radius: 10px;
      border: 1px solid #ddd;
      padding: 20px;
    }
    .detail-btn {
      width: 22px;
      cursor: pointer;
    }
    .pill-box {
      border: 1px solid #000;
      border-radius: 12px;
      padding: 6px 14px;
      display: inline-block;
      min-width: 160px;
      text-align: center;
      background-color: #fff;
    }
    .modal-label {
      font-weight: 600;
      margin-bottom: 4px;
    }
    .manager-buttons {
      position: absolute;
      top: 16px;
      right: 20px;
    }
    .search-panel {
      margin-top: 12px;
      display: flex;
      justify-content: flex-end;
    }
    .search-panel .filter-box {
      width: 230px;
    }
  </style>
</head>

<body class="p-3">

<div class="border border-secondary" style="max-width:1300px; margin:0 auto; background:#ffffff;">

  <!-- 상단 바 -->
  <div class="top-bar d-flex align-items-center">
    <div class="btn-group me-3">
      <button class="btn btn-light btn-sm">회사 로고</button>
      <button class="btn btn-secondary btn-sm">회사 명</button>
    </div>

    <ul class="nav">
      <li class="nav-item"><a class="nav-link text-dark fw-bold" href="#">매출 ▾</a></li>
      <li class="nav-item"><a class="nav-link text-dark" href="#">재고 ▾</a></li>
      <li class="nav-item"><a class="nav-link text-dark" href="#">메뉴 ▾</a></li>
      <li class="nav-item"><a class="nav-link text-dark" href="#">직영점</a></li>
    </ul>

    <div class="ms-auto d-flex gap-2 align-items-center">
      <span>본사 홍길동</span>
      <button class="btn btn-outline-primary btn-sm">로그아웃</button>
    </div>
  </div>

  <!-- 제목 -->
  <div class="p-3">
    <div class="fs-3 fw-bold mb-3">직영점 목록 조회</div>
  </div>

  <!-- 본문 -->
  <div class="px-3 pb-3">
    <div class="section-box">

      <div class="row">
        <!-- 직영점 리스트 -->
        <div class="col-7">
          <table class="table table-hover align-middle">
            <thead>
            <tr class="text-center">
              <th>번호</th>
              <th>직영점명</th>
              <th>지역</th>
              <th>점장명</th>
              <th>상태</th>
              <th></th>
            </tr>
            </thead>
            <tbody id="storeTable">
            <!-- JS로 채움 -->
            </tbody>
          </table>

          <!-- 간단 페이지네이션 (샘플) -->
          <div class="d-flex justify-content-center mt-2">
            <ul class="pagination pagination-sm mb-0">
              <li class="page-item disabled"><a class="page-link">&lt;</a></li>
              <li class="page-item active"><a class="page-link">1</a></li>
              <li class="page-item"><a class="page-link">2</a></li>
              <li class="page-item"><a class="page-link">&gt;</a></li>
            </ul>
          </div>
        </div>

        <!-- 지도 + 검색 -->
        <div class="col-5">

          <!-- 지도 대신 이미지 -->
          <div style="width:100%; height:420px;">
            <img src="/image/map_sample.png"
                 style="width:100%; height:100%; object-fit:cover; border-radius:8px;">
          </div>

          <!-- 지도 아래 검색 UI -->
          <div class="search-panel">
            <div class="filter-box">
              <div class="input-group input-group-sm mb-1">
                <select class="form-select" id="searchType">
                  <option value="all">전체</option>
                  <option value="region">지역</option>
                  <option value="name">직영점명</option>
                  <option value="manager">점장명</option>
                  <option value="status">상태</option>
                </select>
              </div>
              <div class="input-group input-group-sm">
                <input type="text" class="form-control" id="searchKeyword" placeholder="검색어 입력">
                <button class="btn btn-warning" type="button" onclick="searchStore()">검색</button>
              </div>
            </div>
          </div>

        </div>
      </div> <!-- /row -->

    </div>
  </div>

</div> <!-- /outer -->

<!-- 직영점 상세 모달 -->
<div class="modal fade" id="storeDetailModal" tabindex="-1">
  <div class="modal-dialog modal-dialog-centered modal-xl">
    <div class="modal-content">

      <div class="modal-header">
        <h5 class="modal-title fw-bold">직영점 상세 보기</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
      </div>

      <div class="modal-body position-relative">

        <div id="managerButtons" class="manager-buttons d-flex gap-2">
          <button type="button" class="btn btn-warning btn-sm">재고 조회</button>
          <button type="button" class="btn btn-warning btn-sm">판매 메뉴 조회</button>
        </div>

        <div class="row">
          <!-- 왼쪽 -->
          <div class="col-7">

            <div class="row mb-3">
              <div class="col-3 modal-label">직영점</div>
              <div class="col-3 modal-label">상태</div>
            </div>
            <div class="row mb-3">
              <div class="col-3"><div id="mdStoreName" class="pill-box"></div></div>
              <div class="col-3"><div id="mdStatus" class="pill-box"></div></div>
            </div>

            <div class="row mb-3">
              <div class="col-3 modal-label">점장명</div>
              <div class="col-3 modal-label">점장 연락처</div>
            </div>
            <div class="row mb-3">
              <div class="col-3"><div id="mdManagerName" class="pill-box"></div></div>
              <div class="col-3"><div id="mdManagerPhone" class="pill-box"></div></div>
            </div>

            <div class="row mb-2"><div class="col-6 modal-label">주소</div></div>
            <div class="row mb-3"><div class="col-10"><div id="mdAddress" class="pill-box" style="width:100%;"></div></div></div>

            <div class="row mb-2">
              <div class="col-4 modal-label">직영점 전화</div>
              <div class="col-3 modal-label">개점일</div>
            </div>
            <div class="row mb-3">
              <div class="col-4"><div id="mdStorePhone" class="pill-box"></div></div>
              <div class="col-3"><div id="mdOpenDate" class="pill-box"></div></div>
            </div>

            <div class="row mb-2">
              <div class="col-4 modal-label">매장 영업시간</div>
              <div class="col-3 modal-label">폐점일</div>
            </div>
            <div class="row mb-1">
              <div class="col-4"><div id="mdBizTime" class="pill-box"></div></div>
              <div class="col-3"><div id="mdCloseDate" class="pill-box"></div></div>
            </div>

          </div>

          <!-- 오른쪽 -->
          <div class="col-5">
            <div class="d-flex justify-content-between mb-2">
              <div class="text-center">
                <div class="modal-label">저번달 매출</div>
                <div id="mdPrevSales" class="fs-5 fw-bold"></div>
              </div>
              <div class="text-center">
                <div class="modal-label">이번달 매출</div>
                <div id="mdThisSales" class="fs-5 fw-bold"></div>
              </div>
            </div>

            <div class="mt-2">
              <img src="https://picsum.photos/420/260" class="img-fluid rounded" alt="store">
            </div>
          </div>
        </div>

      </div>

      <div class="modal-footer justify-content-center">
        <button type="button" class="btn btn-warning px-4" data-bs-dismiss="modal">닫기</button>
      </div>

    </div>
  </div>
</div>

<script>
  var role = "ROLE_MANAGER";

  var stores = [
    {no:1, name:"용문점", region:"대전광역시 서구 도산로 335", manager:"최정문", status:"영업중",
      managerPhone:"010-0000-0001", storePhone:"042-111-1111", openDate:"2023.01.01",
      bizTime:"11:00 - 22:00", closeDate:"-", prevSales:8000000, thisSales:6000000},
    {no:2, name:"유천점", region:"대전광역시 중구 계백로1606", manager:"홍길동", status:"영업중",
      managerPhone:"010-0000-0002", storePhone:"042-222-2222", openDate:"2023.02.01",
      bizTime:"11:00 - 22:00", closeDate:"-", prevSales:7500000, thisSales:6200000},
    {no:3, name:"송촌점", region:"대전광역시 대덕구 계족산로 25", manager:"김재욱", status:"영업중",
      managerPhone:"010-0000-0003", storePhone:"042-333-3333", openDate:"2023.03.01",
      bizTime:"11:00 - 22:00", closeDate:"-", prevSales:7200000, thisSales:5800000},
    {no:4, name:"신탄진점", region:"대전광역시 대덕구 신탄진로 800-1", manager:"홍길동", status:"영업중",
      managerPhone:"010-0000-0004", storePhone:"042-444-4444", openDate:"2023.03.15",
      bizTime:"11:00 - 22:00", closeDate:"-", prevSales:6500000, thisSales:6100000},
    {no:5, name:"가오점", region:"대전광역시 동구 은어송로 75", manager:"이순신", status:"영업중",
      managerPhone:"010-0000-0005", storePhone:"042-555-5555", openDate:"2023.04.01",
      bizTime:"11:00 - 22:00", closeDate:"-", prevSales:6100000, thisSales:5900000},
    {no:6, name:"대전대동점", region:"대전광역시 동구 계족로 194-37", manager:"배성윤", status:"영업중",
      managerPhone:"010-0000-0006", storePhone:"042-666-6666", openDate:"2023.04.10",
      bizTime:"11:00 - 22:00", closeDate:"-", prevSales:6400000, thisSales:6050000},
    {no:7, name:"대전도안점", region:"대전광역시 서구 도안동로 31번길 11-15", manager:"이재웅",
      status:"폐업", managerPhone:"010-0000-0007", storePhone:"042-777-7777", openDate:"2023.05.01",
      bizTime:"11:00 - 22:00", closeDate:"2024.01.31", prevSales:3000000, thisSales:0},
    {no:8, name:"대전월평점", region:"대전광역시 서구 월평로 69", manager:"정윤찬",
      status:"영업중", managerPhone:"010-0000-0008", storePhone:"042-888-8888",
      openDate:"2023.06.01", bizTime:"11:00 - 22:00", closeDate:"-", prevSales:7000000, thisSales:6500000},
    {no:9, name:"둔산점", region:"대전광역시 서구 문정로 170", manager:"표수정", status:"영업중",
      managerPhone:"010-5169-1244", storePhone:"042-1577-1577", openDate:"2025.11.11",
      bizTime:"11:00 - 22:00", closeDate:"-", prevSales:6000000, thisSales:4000000},
    {no:10, name:"대덕점", region:"대전광역시 유성구 와룡로 3", manager:"함은숙", status:"영업중",
      managerPhone:"010-0000-0010", storePhone:"042-999-9999", openDate:"2023.07.01",
      bizTime:"11:00 - 22:00", closeDate:"-", prevSales:6800000, thisSales:6300000}
  ];

  function renderTable(data) {
    var tbody = document.getElementById("storeTable");
    tbody.innerHTML = "";

    data.forEach(s => {
      var tr = document.createElement("tr");
      tr.className = "text-center";
      tr.innerHTML =
              `<td>${s.no}</td>
         <td>${s.name}</td>
         <td class='text-start'>${s.region}</td>
         <td>${s.manager}</td>
         <td>${s.status}</td>
         <td><img src='/image/detail.png' class='detail-btn' onclick='openStoreDetail(${s.no})'></td>`;
      tbody.appendChild(tr);
    });
  }

  function openStoreDetail(storeNo) {
    var s = stores.find(st => st.no === storeNo);
    if (!s) return;

    document.getElementById("mdStoreName").innerText = s.name;
    document.getElementById("mdStatus").innerText = s.status;
    document.getElementById("mdManagerName").innerText = s.manager;
    document.getElementById("mdManagerPhone").innerText = s.managerPhone;
    document.getElementById("mdAddress").innerText = s.region;
    document.getElementById("mdStorePhone").innerText = s.storePhone;
    document.getElementById("mdOpenDate").innerText = s.openDate;
    document.getElementById("mdBizTime").innerText = s.bizTime;
    document.getElementById("mdCloseDate").innerText = s.closeDate;
    document.getElementById("mdPrevSales").innerText = s.prevSales.toLocaleString();
    document.getElementById("mdThisSales").innerText = s.thisSales.toLocaleString();

    var btnArea = document.getElementById("managerButtons");
    btnArea.style.display = role === "ROLE_MANAGER" ? "flex" : "none";

    new bootstrap.Modal(document.getElementById("storeDetailModal")).show();
  }

  function searchStore() {
    var type = document.getElementById("searchType").value;
    var keyword = document.getElementById("searchKeyword").value.trim();

    if (keyword === "") {
      renderTable(stores);
      return;
    }

    var result = stores.filter(s => {
      if (type === "all")
        return (s.name + s.region + s.manager + s.status).includes(keyword);
      if (type === "region") return s.region.includes(keyword);
      if (type === "name") return s.name.includes(keyword);
      if (type === "manager") return s.manager.includes(keyword);
      if (type === "status") return s.status.includes(keyword);
    });

    renderTable(result);
  }

  window.onload = function () {
    renderTable(stores);  // 검색 안 눌러도 전체 보이게
  };
</script>

</body>
</html>
